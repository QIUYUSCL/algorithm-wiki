

# ğŸŒ³ äºŒå‰æ ‘ (Binary Tree)ï¼šä»é€’å½’åˆ°ç®—æ³•èåˆ

> å½’æ¡£æ—¥æœŸ: 2026/01/20
> 
> æ¶µç›–å‘¨æœŸ: Day 9 - Day 10
> 
> æ ¸å¿ƒä¸»é¢˜: é€’å½’æ€ç»´ã€ç³»ç»Ÿæ ˆä¸å †è¿­ä»£ã€è‡ªåº•å‘ä¸Šæ¨¡å¼ã€å‰ç¼€å’Œå›æº¯

## 1. æ ¸å¿ƒæ€ç»´è½¬æ¢ (Mental Model)

äºŒå‰æ ‘æ˜¯æ•°æ®ç»“æ„çš„åˆ†æ°´å²­ï¼Œæ ¸å¿ƒåœ¨äºæ€ç»´ä»â€œçº¿æ€§â€å‘â€œåˆ†å‰â€çš„è·¨è¶Šï¼Œä»¥åŠå¯¹å†…å­˜æ ˆå¸§ï¼ˆStack Frameï¼‰çš„æ·±åˆ»ç†è§£ã€‚

### 1.1 é€’å½’çš„æœ¬è´¨ï¼šé’»äº•ä¸é“ºè·¯

é€’å½’ä¸æ˜¯é­”æ³•ï¼Œè€Œæ˜¯ **Pointer Chasingï¼ˆæŒ‡é’ˆè¿½é€ï¼‰** ä¸ **System Stackï¼ˆç³»ç»Ÿæ ˆï¼‰** çš„ç»“åˆã€‚

- **é’»äº• (Drill Down)**ï¼šå‡½æ•°è°ƒç”¨è‡ªèº«ï¼Œå‹æ ˆã€‚å¯¹åº” **å‰åºéå† (Pre-order)** çš„é€»è¾‘ï¼ˆå…ˆåŠäº‹ï¼Œå†æ·±å…¥ï¼‰ã€‚
    
- **é“ºè·¯ (Pave Up)**ï¼šå‡½æ•° `return`ï¼Œå¼¹æ ˆã€‚å¯¹åº” **ååºéå† (Post-order)** çš„é€»è¾‘ï¼ˆå…ˆæ·±å…¥ï¼Œå›æ¥æ—¶åŠäº‹ï¼‰ã€‚
    

::: danger ğŸš¨ å†…å­˜è­¦ç¤ºï¼šæ ˆæº¢å‡º (Stack Overflow)

é€šè¿‡ infiniteRecursion å®éªŒæµ‹å¾—ï¼Œæœ¬æœºï¼ˆåŠå¤§å¤šæ•°æ ‡å‡† OS ç¯å¢ƒï¼‰çš„ Stack Limit çº¦ä¸º 8MBã€‚

- åœ¨ä¸åšå°¾é€’å½’ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œæœ€å¤§é€’å½’æ·±åº¦çº¦ä¸º **74,000 å±‚**ã€‚
    
- å¯ç¤ºï¼šç”Ÿäº§ç¯å¢ƒæˆ–å¤„ç†é€€åŒ–ä¸ºé“¾è¡¨çš„æ ‘æ—¶ï¼Œæ…ç”¨é€’å½’ï¼Œä¼˜å…ˆè€ƒè™‘è¿­ä»£æ³•æˆ–å¢å¤§æ ˆç©ºé—´ã€‚
    
    :::
    

### 1.2 æ ‘çš„ç‰©ç†å­˜å‚¨

```cpp
struct TreeNode {
    int val;
    TreeNode *left;
    TreeNode *right;
    TreeNode(int x) : val(x), left(nullptr), right(nullptr) {}
};
// å†…å­˜æ¨¡å‹ï¼šHeap ä¸­åˆ†æ•£çš„èŠ‚ç‚¹é€šè¿‡ Pointer ç›¸äº’è¿æ¥
```

---

## 2. éå†ä½“ç³» (Traversals)

### 2.1 DFSï¼šé€’å½’å…¨å®¶æ¡¶

åˆ©ç”¨ç³»ç»Ÿæ ˆéšå¼ç»´æŠ¤è·¯å¾„ã€‚

- **å‰åº (Pre)**: `æ ¹ -> å·¦ -> å³` (DFS åº)
    
- **ä¸­åº (In)**: `å·¦ -> æ ¹ -> å³` (BST æ’åº)
    
- **ååº (Post)**: `å·¦ -> å³ -> æ ¹` (åˆ é™¤èŠ‚ç‚¹ã€ç®—é«˜åº¦)
    

### 2.2 BFSï¼šå±‚åºéå†

åˆ©ç”¨ **Queue (FIFO)** è¿›è¡Œæ¨ªå‘æ‰«æã€‚

**æ ¸å¿ƒæ¨¡ç‰ˆ (åˆ†å±‚å¤„ç†)**ï¼š


```cpp
while (!q.empty()) {
    int size = q.size(); // ğŸ”’ é”å®šå½“å‰å±‚èŠ‚ç‚¹æ•°
    for (int i = 0; i < size; i++) { // åªå¤„ç†è¿™ä¸€å±‚çš„
        TreeNode* node = q.front(); q.pop();
        if (node->left) q.push(node->left);
        if (node->right) q.push(node->right);
    }
}
```

>[!TIP] 
>
>å·¥ä¸šçº§æ¥å£å†™æ³• é¿å…åœ¨é€’å½’å‡½æ•°ä¸­ç›´æ¥è¿”å› `vector`ï¼ˆä¼šå¯¼è‡´å¤§é‡å†…å­˜æ‹·è´ï¼‰ã€‚åº”é‡‡ç”¨ **Helper Function** æ¨¡å¼ï¼š`void traversal(node, vector<int>& res)` é€šè¿‡å¼•ç”¨ä¼ é€’ç»“æœé›†ã€‚

### 2.3 è¿­ä»£æ³• (Iterative DFS)

åˆ©ç”¨ `std::stack` åœ¨å †å†…å­˜ä¸­æ¨¡æ‹Ÿé€’å½’ï¼Œé¿å…æ ˆæº¢å‡ºã€‚**ä¸­åºè¿­ä»£** æ˜¯éš¾ç‚¹ã€‚

**é€»è¾‘çŠ¶æ€æœº**ï¼š

1. **Drill Left**: åªè¦æœ‰è·¯ï¼Œæ‹¼å‘½å¾€å·¦é’»ï¼Œæ²¿é€”å…¥æ ˆã€‚
    
2. **Backtrack**: æ²¡è·¯äº†ï¼Œå¼¹å‡ºæ ˆé¡¶ï¼ˆè®¿é—®ï¼‰ï¼Œè½¬å‘å³å­æ ‘ã€‚
    

ä»£ç æ®µ

```mermaid
graph TD
    A[Start Loop] --> B{curr != null ?}
    B -- Yes (è¿˜æœ‰å·¦è·¯) --> C[Push curr to Stack]
    C --> D[curr = curr->left]
    D --> A
    B -- No (æ’å¢™) --> E{Stack Empty?}
    E -- Yes --> F[End]
    E -- No --> G[Pop Top as curr]
    G --> H[Record curr->val]
    H --> I[curr = curr->right]
    I --> A
```

**å…³é”®ä»£ç  (ä¸­åº)**ï¼š


```cpp
while(root != nullptr || !st.empty()) {
    if(root != nullptr) {
        st.push(root);      // å­˜åŒ…
        root = root->left;  // é’»äº•
    } else {
        root = st.top();    // å–åŒ…
        st.pop();
        res.push_back(root->val); // åŠäº‹
        root = root->right; // è½¬å‘
    }
}
```

---

## 3. è‡ªåº•å‘ä¸Šæ¨¡å¼ (Bottom-Up Pattern)

è§£å†³æ ‘é«˜ã€å¹³è¡¡ã€ç›´å¾„ç­‰é—®é¢˜çš„é€šç”¨è§£æ³•ã€‚æ ¸å¿ƒåœ¨äº **ååºéå†**ï¼šå…ˆæ‹¿åˆ°å­æ ‘çš„ä¿¡æ¯ï¼Œæ•´åˆåå†æ±‡æŠ¥ç»™çˆ¶èŠ‚ç‚¹ã€‚

### 3.1 æ¨¡å¼è§£æ

- **è¾“å…¥**ï¼šå­æ ‘çš„è¿”å›å€¼ï¼ˆé«˜åº¦ã€æ˜¯å¦å¹³è¡¡ç­‰ï¼‰ã€‚
    
- **å¤„ç†**ï¼šå½“å‰èŠ‚ç‚¹çš„é€»è¾‘ï¼ˆè®¡ç®—ç›´å¾„ã€åˆ¤æ–­å·®å€¼ï¼‰ã€‚
    
- **è¾“å‡º**ï¼šå‘çˆ¶èŠ‚ç‚¹æ±‡æŠ¥è‡ªèº«å±æ€§ï¼ˆé€šå¸¸æ˜¯ `max(L, R) + 1`ï¼‰ã€‚
    

### 3.2 ç»å…¸æ¡ˆä¾‹ï¼šäºŒå‰æ ‘ç›´å¾„ ([543])

åˆ©ç”¨ **å…¨å±€å˜é‡** è®°å½•è¿‡ç¨‹ä¸­çš„æœ€å¤§å€¼ï¼Œåˆ©ç”¨ **è¿”å›å€¼** ç»´æŠ¤é€’å½’é€»è¾‘ã€‚


```mermaid
sequenceDiagram
    participant P as Parent
    participant N as Node
    participant L as LeftChild
    participant R as RightChild
    
    P->>N: getHeight()
    N->>L: getHeight()
    L-->>N: return LeftHeight
    N->>R: getHeight()
    R-->>N: return RightHeight
    Note over N: Update Global Ans:<br/>max(Ans, L + R)
    N-->>P: return max(L, R) + 1
```

> [!NOTE] ä¼˜åŒ–æŠ€å·§ ([110] å¹³è¡¡äºŒå‰æ ‘)
> 
> å¦‚æœå‘ç°å­æ ‘å·²ç»ä¸å¹³è¡¡ï¼Œç›´æ¥è¿”å›ç‰¹å®šé”™è¯¯ç ï¼ˆå¦‚ -1ï¼‰ï¼Œå®ç° å‰ªæï¼Œå°†å¤æ‚åº¦ä» $O(N^2)$ é™ä¸º $O(N)$ã€‚

---

## 4. ç®—æ³•èåˆï¼šå‰ç¼€å’Œä¸å›æº¯

é¢˜ç›®ï¼š[437] è·¯å¾„æ€»å’Œ III (Path Sum III)

éš¾ç‚¹ï¼šå¯»æ‰¾ä»»æ„å‘ä¸‹çš„è·¯å¾„å’Œç­‰äº targetã€‚

æŠ€æœ¯æ ˆï¼šDFS + Hash Map (Prefix Sum) + Backtrackingã€‚

### 4.1 æ•°å­¦åŸç†

$$\text{Target Path} = \text{CurrPrefix} - \text{OldPrefix}$$

$$\therefore \text{Find OldPrefix} = \text{CurrPrefix} - \text{Target}$$

### 4.2 å›æº¯çš„æ ¸å¿ƒï¼šæ—¶ç©ºéš”ç¦»

Map ä¸­æ°¸è¿œåªä¿å­˜ **å½“å‰èŠ‚ç‚¹åˆ°æ ¹èŠ‚ç‚¹** è¿™ä¸€æ¡è·¯å¾„ä¸Šçš„å‰ç¼€å’Œã€‚

- **è¿›å…¥èŠ‚ç‚¹**ï¼š`map[currSum]++` (æ³¨å†Œ)
    
- **ç¦»å¼€èŠ‚ç‚¹**ï¼š`map[currSum]--` (æ³¨é”€)
    


```mermaid
graph TD
    Root((Root: 10)) --> L((L: 5))
    Root --> R((R: -3))
    L --> LL((LL: 3))
    
    subgraph Map_State_at_LL
    D1["0:1"]
    D2["10:1"]
    D3["15:1"]
    D4["18:1"]
    end
    
    subgraph Map_State_at_R
    R1["0:1"]
    R2["10:1"]
    R3["7:1"]
    end
    
    LL -- "Backtrack (map[18]--)" --> L
    L -- "Backtrack (map[15]--)" --> Root
    Root -- "Switch Branch" --> R
    
    style Map_State_at_LL fill:#e1f5fe
    style Map_State_at_R fill:#fff9c4
    
    %% è¿™é‡ŒæŠŠ Note è¯­æ³•æ”¹æˆäº†ä¸€ä¸ªæ™®é€šçš„è™šçº¿è¿æ¥èŠ‚ç‚¹
    NoteNode["R èŠ‚ç‚¹çœ‹ä¸åˆ°<br>L åˆ†æ”¯çš„æ•°æ®<br>å› ä¸ºå·²è¢«å›æº¯æ¸…é™¤"]
    Root -.-> NoteNode
    style NoteNode fill:#fff,stroke:#333,stroke-dasharray: 5 5
```

### 4.3 ä»£ç æ˜“é”™ç‚¹


```cpp
// âŒ é”™è¯¯å†™æ³•
if (prefixMap.count(target - currSum)) 

// âœ… æ­£ç¡®å†™æ³•ï¼šå†å² = å½“å‰ - ç›®æ ‡
if (prefixMap.count(currSum - target)) 
```

---

## 5. å¾…åŠä¸å¤ä¹  (To-Do)

- **å¾…åŠ**: [215] æ•°ç»„ç¬¬ K å¤§å…ƒç´ çš„ **Quick Select** è§£æ³•ï¼ˆDay 11/12 å®‰æ’ï¼‰ã€‚
    
- **å¾…åŠ**: ã€ŠEffective C++ã€‹æ¡æ¬¾ 11-12 (operator= å®ç°ç»†èŠ‚)ã€‚
    
- **å¤ä¹ **: æ¯å¤©æ‰‹å†™ä¸€æ¬¡ DFS é€’å½’æ¨¡ç‰ˆä¸ä¸­åºè¿­ä»£æ¨¡ç‰ˆï¼Œä¿æŒè‚Œè‚‰è®°å¿†ã€‚
